<!DOCTYPE html>
<html lang="en">

<header>
	<title>The Fatalistic Game of Life</title>
	<meta name="description" content="Actuarial statistics toy.">
	<meta name="keywords" content="toy statistics actuarial actuary">
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link type="text/css" rel="stylesheet" href="http://jqueryui.com/themes/base/jquery.ui.all.css">
	<link type="text/css" rel="stylesheet" href="d3/src/css/graph.css">
	<link type="text/css" rel="stylesheet" href="d3/src/css/detail.css">
	<link type="text/css" rel="stylesheet" href="d3/src/css/legend.css">
	<link type="text/css" rel="stylesheet" href="d3/src/css/lines.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.min.js"></script>
	<script src="d3/vendor/d3.min.js"></script>
	<script src="d3/vendor/d3.layout.min.js"></script>
	<script src="d3/rickshaw.min.js"></script>
	<script src="d3/rickshaw.js"></script>

	<style>
		.rickshaw_graph .detail .x_label { display: none }
		.rickshaw_graph .detail .item { line-height: 1.4; padding: 0.5em }
		.detail_swatch { float: right; display: inline-block; width: 10px; height: 10px; margin: 0 4px 0 0 }
	</style>

</header>

<body>

	<h1>Hello, {{ name }}</h1>

	<p>Income - {{ income }}</p>
	<p>Networth - {{ networth }}</p>
	<p>Job - {{ job }}</p>
<div id="chart_container">
	<div id="chart"></div>
	<div id="legend_container">
		<div id="smoother" title="Smoothing"></div>
		<div id="legend"></div>
	</div>
	<div id="slider"></div>
</div>

<script>
var lifespan = 0;
var max_lifespan = 120;

//calculates prob. of dying at each age
for (var dead = false; !dead; lifespan++) {
	if(Math.pow(lifespan/max_lifespan, 6) > Math.random())
		dead = true;
} 

var seriesData = [ [] ]; // add more arrays for more bars/year
var random = new Rickshaw.Fixtures.RandomData(150);

for (var i = 1; i <= lifespan; i++) {
	//add (random-ish) coordinates to graph 
	seriesData[0].push({x:i, y: 1000000*(Math.random()*.2 + 0.8)*Math.sin((i*Math.PI)/140)});
}

// instantiate our graph

var graph = new Rickshaw.Graph( {
	element: document.getElementById("chart"),
	width: 8 * lifespan,
	height: 300,
	renderer: 'bar',
	series: [
            {
            	color: "#bb0000",
            	data: seriesData[0],
            	name: 'Net Worth',
            }
    	]
} );

var hoverDetail = new Rickshaw.Graph.HoverDetail( {
	graph: graph,
	formatter: function(series, x, y) {
		var swatch = '<span class="detail_swatch" style="background-color: ' + series.color + '"></span>';
		var content = swatch + series.name + ": $" + parseInt(y);
		content += '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Age: ' + x;
		return content;	
	}
} );

var axes = new Rickshaw.Graph.Axis.X( {
	graph: graph
} );

graph.render();
</script>
</body>
</html>