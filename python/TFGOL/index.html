<!DOCTYPE html>
<html lang="en">

<header>
	<title>The Fatalistic Game of Life</title>
	<meta name="description" content="Actuarial statistics toy.">
	<meta name="keywords" content="toy statistics actuarial actuary">
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link type="text/css" rel="stylesheet" href="http://jqueryui.com/themes/base/jquery.ui.all.css">


	<style>
		div.chart_container, div.year_info { display: inline; }
		.graphdata{
			float: left;
			margin-left:auto;
			margin-right:auto;
		}
		.yeardata{
			clear: both;
			margin-left:auto;
			margin-right:auto;
			width:50%;
			height: 100px;
			border-style:solid;
			border-width:1px;
		}
		body {
			margin: 0px;
			padding: 0px;
		}
		#container {
			width : 1000px;
			height: 384px;
			margin: 8px auto;
		}
	</style>

</header>

<body>

	<h1>Hello, {{ name }}</h1>

	<p>Income - {{ income }}</p>
	<p>Networth - {{ networth }}</p>
	<p>Job - {{ job }}</p>
	<div id="container" class = "graphdata"></div>
	<div id="hover_info" class = "graphdata"></div>
	
     <script type="text/javascript" src="flotr2/flotr2.min.js"></script>
     <script type="text/javascript">
	 (function basic_bars(container) {
		var lifespan = 0,
			max_lifespan = 120;

		//calculates prob. of dying at each age
		for (var dead = false; !dead; lifespan++) {
			if(Math.pow(lifespan/max_lifespan, 6) > Math.random())
				dead = true;
		} 
		var
			d1 = [],
			// First data series
			d2 = [],
			// Second data series
			d3 = [],
			point, // Data point variable declaration
			i;

		for (i = 0; i < lifespan; i++) {
			//point = [x, y]
			//without a shift of 0.5 to the right, bar i would be centered at x=i
			point = [i+0.5, 1000000*(Math.random()*.2 + 0.8)*Math.sin((i*Math.PI)/140)];
			d1.push(point);

			point = [i+0.5, 500000*(Math.random()*.2 + 0.8)*Math.sin((i*Math.PI)/130)];
			d2.push(point);
			
			d3.push("Engineer");
		};

		// Draw the graph
		Flotr.draw(
		container, [d1, d2], {
			bars: {
				show: true,
				horizontal: false,
				shadowSize: 0,
				barWidth: 0.9
			},
			mouse: {
				track: true,
				relative: true,
				trackFormatter: function (obj) {
					var year = parseInt(obj.x);
					document.getElementById("hover_info").innerHTML = "Age: " + year + '<br>';
					document.getElementById("hover_info").innerHTML += "Net Worth: $" + parseInt(d1[year][1]) + '<br>';
					document.getElementById("hover_info").innerHTML += "Annual Salary: $" + parseInt(d2[year][1]) + '<br>';
					document.getElementById("hover_info").innerHTML += "Occupation: " + d3[year];
					return null;
				}
			},
			yaxis: {
				showLabels: false,
				min: 0,
				max: 1000000
			}
		});
		
		Flotr.EventAdapter.observe(container, 'flotr:click', function(position) {
			// may consider adding a conditional for y-values so only detects when a bar is clicked
			var year = parseInt(position.x);
			document.getElementById("click_info").innerHTML = "Age: " + year + '<br>';
			document.getElementById("click_info").innerHTML += "Net Worth: $" + parseInt(d1[year][1]) + '<br>';
			document.getElementById("click_info").innerHTML += "Annual Salary: $" + parseInt(d2[year][1]) + '<br>';
			document.getElementById("click_info").innerHTML += "Occupation: " + d3[year];
		});
})(document.getElementById("container"));
     </script>
	</div>
	<div id="click_info" class = "yeardata">
		
	</div>
</script>
</body>
</html>